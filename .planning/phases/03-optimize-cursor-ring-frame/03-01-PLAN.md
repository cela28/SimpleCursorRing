---
phase: 03-optimize-cursor-ring-frame
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - SimpleCursorRing/Core.lua
autonomous: true

must_haves:
  truths:
    - "Ring frame is 1x1 pixels (minimal frame size)"
    - "Mouse and keyboard input disabled on ring frame"
    - "Ring texture displays at correct size independent of frame size"
    - "Ring still follows cursor smoothly"
    - "Size changes via UpdateRingSize update texture size, not frame size"
    - "Color, class color, and texture settings still work correctly"
  artifacts:
    - path: "SimpleCursorRing/Core.lua"
      provides: "Optimized ring frame with 1x1 size, disabled input, independent texture sizing"
      contains: "SetSize(1, 1)"
  key_links:
    - from: "SimpleCursorRing/Core.lua (ringFrame)"
      to: "ringTexture"
      via: "Independent sizing: texture uses SetSize() + SetPoint('CENTER') instead of SetAllPoints"
      pattern: "ringTexture:SetSize.*ringTexture:SetPoint.*CENTER"
    - from: "SimpleCursorRing/Core.lua (UpdateRingSize)"
      to: "ringFrame.texture"
      via: "Size updates target texture, not frame"
      pattern: "ringFrame\\.texture:SetSize"
---

<objective>
Optimize the cursor ring frame to use minimal 1x1 size with disabled input and independent texture sizing, reducing per-frame rendering overhead.

Purpose: Reduces frame processing overhead by minimizing frame dimensions, disabling unnecessary mouse/keyboard hit testing, and decoupling texture size from frame size. Matches established WoW addon optimization patterns.
Output: Modified Core.lua with optimized frame setup and updated size function.
</objective>

<execution_context>
@/home/sntanavaras/.claude/get-shit-done/workflows/execute-plan.md
@/home/sntanavaras/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-optimize-cursor-ring-frame/03-RESEARCH.md
@SimpleCursorRing/Core.lua
</context>

<tasks>

<task type="auto">
  <name>Task 1: Optimize ring frame to 1x1 with disabled input and independent texture sizing</name>
  <files>SimpleCursorRing/Core.lua</files>
  <action>
Modify the ring frame creation and related functions in Core.lua. There are exactly 4 changes:

1. **Frame size** (line ~23): Change `ringFrame:SetSize(64, 64)` to `ringFrame:SetSize(1, 1)` -- minimal frame size for reduced processing overhead.

2. **Disable input** (after SetFrameLevel line ~25): Add two new lines:
   ```lua
   ringFrame:EnableMouse(false)
   ringFrame:EnableKeyboard(false)
   ```

3. **Texture sizing** (line ~30): Replace `ringTexture:SetAllPoints(ringFrame)` with independent texture sizing:
   ```lua
   ringTexture:SetSize(64, 64)
   ringTexture:SetPoint("CENTER")
   ```
   CRITICAL: Do NOT use SetAllPoints with a 1x1 frame -- the texture would inherit 1x1 size and become invisible (see RESEARCH.md Pitfall 1).

4. **UpdateRingSize function** (line ~44): Change `ringFrame:SetSize(size, size)` to `ringFrame.texture:SetSize(size, size)` -- size changes now target the texture directly since frame stays at 1x1.

Do NOT change:
- The OnUpdate handler (already uses ClearAllPoints pattern correctly)
- The texture path, vertex color, or any other texture properties
- The event handling, SavedVariables, or global API
- The Settings.lua file (it calls SimpleCursorRing.UpdateRingSize which internally routes correctly)
- Any frame strata or frame level settings
  </action>
  <verify>
1. Read Core.lua and confirm:
   - `ringFrame:SetSize(1, 1)` is present
   - `ringFrame:EnableMouse(false)` is present
   - `ringFrame:EnableKeyboard(false)` is present
   - `ringTexture:SetSize(64, 64)` is present (not SetAllPoints)
   - `ringTexture:SetPoint("CENTER")` is present
   - `UpdateRingSize` uses `ringFrame.texture:SetSize(size, size)` not `ringFrame:SetSize(size, size)`
2. Grep for `SetAllPoints(ringFrame)` in Core.lua -- should return NO matches (removed)
3. Grep for `ringFrame:SetSize` in Core.lua -- should match only `SetSize(1, 1)` (not 64,64 or size,size)
4. Confirm Settings.lua is unchanged (no modifications needed)
  </verify>
  <done>
Core.lua uses 1x1 frame with EnableMouse(false) and EnableKeyboard(false), texture sized independently via SetSize(64,64) + SetPoint("CENTER"), and UpdateRingSize targets texture instead of frame. No changes to Settings.lua, OnUpdate handler, or global API.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify ring optimization in-game</name>
  <what-built>Optimized ring frame: 1x1 frame with disabled input and independent texture sizing. All visual behavior should be identical to before.</what-built>
  <how-to-verify>
1. Launch WoW and log into a character
2. Verify ring is visible and follows cursor smoothly (no jitter, no lag)
3. Open settings with `/scr` and verify:
   a. Size slider changes ring size visually (20-200px range)
   b. Color picker changes ring color
   c. Class color toggle applies class color
   d. Ring style dropdown changes texture
4. Verify ring does NOT intercept mouse clicks (click through the ring area -- game world/UI behind it should respond)
5. /reload and verify settings persist correctly

Expected: Ring behaves exactly as before the optimization. The only difference is internal frame structure (not visible to user).
  </how-to-verify>
  <resume-signal>Type "approved" if ring works correctly, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
1. Core.lua contains `ringFrame:SetSize(1, 1)` (not 64, 64)
2. Core.lua contains `ringFrame:EnableMouse(false)` and `ringFrame:EnableKeyboard(false)`
3. Core.lua contains `ringTexture:SetSize(64, 64)` and `ringTexture:SetPoint("CENTER")` (not SetAllPoints)
4. Core.lua UpdateRingSize uses `ringFrame.texture:SetSize(size, size)` (not ringFrame:SetSize)
5. No occurrences of `SetAllPoints(ringFrame)` in Core.lua
6. Settings.lua is unmodified
7. OnUpdate handler is unmodified (still uses ClearAllPoints + SetPoint pattern)
</verification>

<success_criteria>
- Ring frame uses 1x1 size with independent texture sizing
- Mouse and keyboard input disabled on ring frame
- Ring still follows cursor smoothly with all existing features working
- No visual or functional regression confirmed by user
</success_criteria>

<output>
After completion, create `.planning/phases/03-optimize-cursor-ring-frame/03-01-SUMMARY.md`
</output>
